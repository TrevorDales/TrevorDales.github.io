<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
        Lab 1: Artemis and Bluetooth
    </title><link href="https://TrevorDales.github.io/ atom.xml" title="Trevor Dales" rel=alternate type=application/atom+xml><link href=https://TrevorDales.github.io/main.css media=screen rel=stylesheet><meta content="Hi! My name is Trevor." name=description><meta content="Hi! My name is Trevor." name=description><meta content="index, nofollow" name=robots><meta content="Trevor Dales" property=og:title><meta content=article property=og:type><meta content=https://TrevorDales.github.io/MAE4190/lab1/ property=og:url><meta content="Hi! My name is Trevor." property=og:description><meta content="Trevor Dales" property=og:site_name><meta content="default-src 'self' ws://127.0.0.1:1024/; img-src 'self' https://*; script-src 'self'; style-src 'self'; font-src 'self'; frame-src https://www.youtube.com https://player.vimeo.com;" http-equiv=Content-Security-Policy><body><header><div class=navbar><div class="nav-title nav-navs"><a class="nav-links home-title" href=https://TrevorDales.github.io>Trevor Dales</a></div><nav class="nav-title nav-navs"><a class=nav-links href=/MAE4190> <img 4190 alt=MAE height=15 src=/menu_icon/projects.png width=15> MAE 4190</a><a class=nav-links href=/contact/contact> <img alt=Contact height=15 src=/menu_icon/resume.png width=15> Contact</a></nav><nav class="socials nav-navs"><label class=theme-switcher for=themeswitch><div class=background></div> <input id=themeswitch type=checkbox> <div class=switch><img alt="theme switch to dark" class=moon src=/menu_icon/moon.png><img alt="theme switch to light" class=sun src=/menu_icon/sun.png></div></label></nav></div></header><div class=content><main><article><div class=title><h2>Lab 1: Artemis and Bluetooth</h2><div class=meta>Posted on <time>2025-01-30</time></div></div><section class=body><br><h2 id=1a>1a</h2><p>In the first part of the lab, I established wired communication and control over the RedBoard Artemis Nano. I started with a blink test, and then tested the ability of the board to read and write using the serial monitor. <br> <br><div align=center><iframe <pre class=z-code height=315 src=https://www.youtube.com/embed/d6p6UubQxzs width=175><code><span class="z-text z-plain">allowfullscreen> </span></code></iframe><h5 id=blink-test>Blink Test</h5></div><br><br><div align=center><iframe <pre class=z-code height=315 src=https://www.youtube.com/embed/jE8nBZ8M0LM width=175><code><span class="z-text z-plain">allowfullscreen> </span></code></iframe><h5 id=serial-test>Serial Test</h5></div><br><p>Next, I tested some of the onboard sensors - first the temperature sensor: <br></p><img alt="Rising Temperature Graph" src=/Lab1/tempgraph.png style=display:block><div align=center><h5 id=the-serial-monitor-visually-shows-an-increase-in-temperature-degf-when-the-board-is-pressed-to-my-hand>The serial monitor visually shows an increase in temperature (Â°F) when the board is pressed to my hand.</h5></div><br><p>And then the microphone:</p><br><br><div align=center><iframe <pre class=z-code height=315 src=https://www.youtube.com/embed/6gqOR4L8DFw width=175><code><span class="z-text z-plain">allowfullscreen> </span></code></iframe><h5 id=whistling-at-the-board-causing-the-frequency-to-spike>Whistling at the board, causing the frequency to spike.</h5></div><br><p>The above tests were performed using the following example sketches included in the Arduino IDE:<ul><li>Basics_blink<li>Apollo3_serial<li>Apollo3_analogRead<li>PDM_microphoneOutput</ul><br><br><h2 id=1b>1b</h2><p>The next part of the lab focused on establishing a wireless connection to the Artemis through Bluetooth Low Energy (BLE). I began by activating a virtual environment and starting a Jupyter server.</p><br><div align=center><img alt="Virtual Environment terminal screenshot" src=/Lab1/VirtualEnvironmentSS.png style=display:block><img alt="Virtual Environment terminal screenshot" src=/Lab1/jupytertree.png style=display:block><h5 id=activated-ve-and-file-tree-from-jupyter-server>Activated VE and file tree from Jupyter server</h5></div><br><p>After this, I had the Artemis print its MAC address, which I then inputted to the connections.yaml file in the Jupyter notebook. I also generated a Universally Unique Identifier (UUID) to ensure that my laptop only recognizes my board's services, and not any other boards. After this initial setup, I was able to establish a bluetooth connection between my laptop and my Artemis board.</p><br><div align=center><img alt="Virtual Environment terminal screenshot" src=/Lab1/mac.png style=display:block><img alt="Virtual Environment terminal screenshot" src=/Lab1/uuid.png style=display:block><img alt="Virtual Environment terminal screenshot" src=/Lab1/bluetoothconnect.png style=display:block><h5 id=successful-bluetooth-connection>Successful bluetooth connection!</h5></div><br><br><h1 id=task-1>Task 1</h1><p>This task involved writing a new command type for the artemis, called echo:<pre class=z-code><code><span class="z-text z-plain">case ECHO:
</span><span class="z-text z-plain">    char char_arr[MAX_MSG_SIZE];
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    // Extract the next value from the command string as a character array
</span><span class="z-text z-plain">    success = robot_cmd.get_next_value(char_arr);
</span><span class="z-text z-plain">    if (!success)
</span><span class="z-text z-plain">        return;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    tx_estring_value.clear();
</span><span class="z-text z-plain">    tx_estring_value.append("Trevor's Robot Says: ");
</span><span class="z-text z-plain">    tx_estring_value.append(char_arr);
</span><span class="z-text z-plain">    tx_estring_value.append("!!!!");
</span><span class="z-text z-plain">    tx_characteristic_string.writeValue(tx_estring_value.c_str());
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    break;
</span></code></pre><br> Using this command, I sent a string to my artemis, and my computer recieved and printed an augmented string: <img alt="Virtual Environment terminal screenshot" src=/Lab1/echo.png style=display:block><br><br><h1 id=task-2>Task 2</h1><p>This task included another command type that received 3 floats, extracted them, and printed them to the Arduino serial monitor.<pre class=z-code><code><span class="z-text z-plain">case SEND_THREE_FLOATS:
</span><span class="z-text z-plain">    float float_a, float_b, float_c;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    // Extract the next value from the command string as a float
</span><span class="z-text z-plain">    success = robot_cmd.get_next_value(float_a);
</span><span class="z-text z-plain">    if (!success)
</span><span class="z-text z-plain">        return;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    // Extract the next value from the command string as a float
</span><span class="z-text z-plain">    success = robot_cmd.get_next_value(float_b);
</span><span class="z-text z-plain">    if (!success)
</span><span class="z-text z-plain">        return;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    // Extract the next value from the command string as a float
</span><span class="z-text z-plain">    success = robot_cmd.get_next_value(float_c);
</span><span class="z-text z-plain">    if (!success)
</span><span class="z-text z-plain">        return;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    Serial.print("3 Floats: ");
</span><span class="z-text z-plain">    Serial.print(float_a);
</span><span class="z-text z-plain">    Serial.print(", ");
</span><span class="z-text z-plain">    Serial.print(float_b);
</span><span class="z-text z-plain">    Serial.print(", ");
</span><span class="z-text z-plain">    Serial.print(float_c);
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    break;
</span></code></pre><img alt="Virtual Environment terminal screenshot" src=/Lab1/3floats.png style=display:block><br><br><h1 id=task-3>Task 3</h1><p>This task utilized the millis() function in another new command type to get the time in milliseconds since boot.<pre class=z-code><code><span class="z-text z-plain">case GET_TIME_MILLIS:
</span><span class="z-text z-plain">    double t;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    tx_estring_value.clear();
</span><span class="z-text z-plain">    tx_estring_value.append("T:");
</span><span class="z-text z-plain">    t = millis();
</span><span class="z-text z-plain">    tx_estring_value.append(t);
</span><span class="z-text z-plain">    tx_characteristic_string.writeValue(tx_estring_value.c_str());
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    break;
</span></code></pre><img alt="Virtual Environment terminal screenshot" src=/Lab1/millis.png style=display:block><br><br><h1 id=task-4>Task 4</h1><p>Task 4 was to set up a notification handler for the string GAAT characteristic. This notif handler function runs whenever the string characteristic is updating, making keeping track of the variable easier.<pre class=z-code><code><span class="z-text z-plain">def notif_handler(uuid, byteArray):
</span><span class="z-text z-plain">    s = ble.bytearray_to_string(byteArray)
</span><span class="z-text z-plain">    print(s)
</span></code></pre><br><pre class=z-code><code><span class="z-text z-plain">ble.start_notify(ble.uuid['RX_STRING'], notif_handler)
</span></code></pre><br> After running these, sending the command automatically results in the time getting printed: <img alt="Virtual Environment terminal screenshot" src=/Lab1/notif.png style=display:block><br><h1 id=task-5>Task 5</h1><p>For task 5, I read the current time and sent it to my computer as many times as possible in 5 seconds. I was able to send 139 messages - each message is 13 bytes, so this comes out to nearly 390 bytes per second.<pre class=z-code><code><span class="z-text z-plain">case GET_TIME_MILLIS_5s:
</span><span class="z-text z-plain">    double t1, initial_t;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    initial_t = millis();
</span><span class="z-text z-plain">    while (millis() - initial_t < 5000)
</span><span class="z-text z-plain">    {
</span><span class="z-text z-plain">        tx_estring_value.clear();
</span><span class="z-text z-plain">        tx_estring_value.append("Time:");
</span><span class="z-text z-plain">        t1 = millis();
</span><span class="z-text z-plain">        tx_estring_value.append(t1);
</span><span class="z-text z-plain">        tx_characteristic_string.writeValue(tx_estring_value.c_str());
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">    break;
</span></code></pre><img alt="Virtual Environment terminal screenshot" src=/Lab1/millis5s.png style=display:block><br><h1 id=task-6>Task 6</h1><p>Next, I added the timestamps to an array rather than writing each on eto the GAAT characteristic each loop. After the data is collected, I sent it all over at once.<pre class=z-code><code><span class="z-text z-plain">case SEND_TIME_DATA:
</span><span class="z-text z-plain">            
</span><span class="z-text z-plain">    for (int i=0; i&LT100; i++){
</span><span class="z-text z-plain">        currentMillis = millis();
</span><span class="z-text z-plain">        time_stamps[i] = currentMillis;
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    for (int i=0; i&LT100; i++){
</span><span class="z-text z-plain">    tx_estring_value.clear();
</span><span class="z-text z-plain">    tx_estring_value.append("Time:");
</span><span class="z-text z-plain">    tx_estring_value.append((double)time_stamps[i]);
</span><span class="z-text z-plain">    tx_characteristic_string.writeValue(tx_estring_value.c_str());
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    // Reset the array and index after sending data
</span><span class="z-text z-plain">    memset(time_stamps, 0, sizeof(time_stamps));  // Clear the array
</span><span class="z-text z-plain">    
</span><span class="z-text z-plain">    break;
</span></code></pre><img alt="Virtual Environment terminal screenshot" src=/Lab1/sendtime.png style=display:block><br><h1 id=task-7>Task 7</h1><p>For task 7 I implemented tempurature logging in a method similar to the previous task. This time, I also included timestamps for the data.<pre class=z-code><code><span class="z-text z-plain">case GET_TEMP_READINGS:
</span><span class="z-text z-plain">    for (int i=0; i&LT30; i++){
</span><span class="z-text z-plain">        currentMillis = millis();
</span><span class="z-text z-plain">        time_stamps[i] = (int)currentMillis;
</span><span class="z-text z-plain">        temps[i] = (float)getTempDegF();
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">    for (int i=0; i&LT20; i++){
</span><span class="z-text z-plain">        tx_estring_value.clear();
</span><span class="z-text z-plain">        tx_estring_value.append("Time:");
</span><span class="z-text z-plain">        tx_estring_value.append((double)time_stamps[i]);
</span><span class="z-text z-plain">        tx_estring_value.append(",");
</span><span class="z-text z-plain">        tx_estring_value.append("F:");
</span><span class="z-text z-plain">        tx_estring_value.append((double)temps[i]);
</span><span class="z-text z-plain">        tx_characteristic_string.writeValue(tx_estring_value.c_str());
</span><span class="z-text z-plain">    }
</span><span class="z-text z-plain">        
</span><span class="z-text z-plain">    break;
</span></code></pre><img alt="Virtual Environment terminal screenshot" src=/Lab1/tempandtime.png style=display:block><br><h1 id=task-8>Task 8</h1><p>Method 1 records data much slower. The advantage it has is continuous communication with the computer, if you wanted to offload some of the compute for some reason. You also don't need any onboard storage for this. However, method 2 is much faster. The data comes in at way higher resolution, but the computer has to wait until all of it is collected to see any of it. This could also be useful if we wanted to measure values that changed really quickly over a short period of time. It is worth noting that this takes up precious space on the board.</p><br><p>I can see that my artemis is recording at about 4 times per millisecond, or 4000 times per second. Of the 350kB available, using 2 floats per message we can store 350000/8 = 43750 data pairs before running out of space.</p><br><h2 id=collaboration>Collaboration</h2><p>I worked with Jack Long and Lucca Correia extensively. I also referenced Daria's website from last year for writing to a GAAT characteristic.</section></article></main></div><footer><section><nav><a class="nav-links social" rel="noopener noreferrer" href=https://github.com/TrevorDales target=_blank> <img alt=github src=/social_icons/github.svg title=github> </a></nav><nav><span classname=desktop-only>This blog is powered by <a rel="noopener noreferrer" href=https://getzola.org/ target=_blank>Zola</a> with theme by <a rel="noopener noreferrer" href=https://syedzayyan.com/ target=_blank>SZM</a></span></nav></section><script src=https://TrevorDales.github.io/js/main.js></script></footer>